---
title: 6.æ–‡ç« åœ¨é¦–é¡µæ˜¾ç¤ºâ€œæ›´æ–°â€æ ‡å¿—
date: 2025-01-18 23:11:20
categories:
  - Hexo
tags:
  - HTML
  - Hexo
  - Fluid
  - js
  - css
---


åšå®¢ä¸­ï¼Œæ‚¨å¯èƒ½å¸Œæœ›æ ‡è®°å“ªäº›æ–‡ç« æœ€è¿‘æ›´æ–°è¿‡ï¼Œä»¥ä¾¿è¯»è€…æ›´æ–¹ä¾¿åœ°è¯†åˆ«æœ€æ–°å†…å®¹ã€‚æœ¬æ–‡å°†æ•™æ‚¨å¦‚ä½•æ·»åŠ ä¸€ä¸ªâ€œUpdatedâ€æ ‡å¿—ï¼Œå¹¶åŸºäºæ›´æ–°æ—¶é—´åŠ¨æ€éšè—æ ‡å¿—ï¼ˆå¦‚è¶…è¿‡ 7 å¤©åéšè—ï¼‰ã€‚

1. ä½¿ç”¨æ–‡ç« çš„ `updated` å±æ€§åˆ¤æ–­æ–‡ç« æ˜¯å¦æœ‰æ›´æ–°ã€‚
2. åœ¨æ¨¡æ¿ä¸­ä¸ºâ€œUpdatedâ€æ ‡å¿—æ·»åŠ  `data-updated` å±æ€§ï¼Œè®°å½•æ›´æ–°æ—¶é—´ã€‚
3. ä½¿ç”¨ JavaScript è„šæœ¬ï¼Œåœ¨é¡µé¢åŠ è½½æ—¶è®¡ç®—æ›´æ–°æ—¶é—´ä¸å½“å‰æ—¶é—´çš„å·®è·ï¼ŒåŠ¨æ€æ§åˆ¶æ ‡å¿—çš„æ˜¾ç¤ºæˆ–éšè—ã€‚
4. ä½¿ç”¨ CSS ä¸ºâ€œUpdatedâ€æ ‡å¿—æ·»åŠ æ ·å¼ã€‚

---



### **æ­¥éª¤ 1ï¼šä¿®æ”¹æ–‡ç« æ¨¡æ¿**

æˆ‘ä»¬éœ€è¦åœ¨æ–‡ç« åˆ—è¡¨æ¨¡æ¿ä¸­æ·»åŠ â€œUpdatedâ€æ ‡å¿—ã€‚æ‰¾åˆ° `index.ejs`ï¼ˆé¦–é¡µï¼‰ï¼Œé€šå¸¸è·¯å¾„ï¼š`themes/fluid/layout/index.ejs`

åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­æ‰¾åˆ°`index-btm post-metas`ï¼ˆå¦‚æ—¥æœŸæ˜¾ç¤ºçš„ä½ç½®), æ’å…¥ä»¥ä¸‹å†…å®¹ï¼š

```ejs
<div class="index-btm post-metas">
  <% if (theme.index.post_meta.date) { %>
    <div class="post-meta">
      <i class="iconfont icon-date"></i>
      <time datetime="<%= full_date(post.date, 'YYYY-MM-DD HH:mm') %>" pubdate>
        <%- date(post.date, config.date_format) %>
      </time>

      <%# -------- åŠ å…¥ä»¥ä¸‹å†…å®¹ --------%>
      <% if (post.updated) { %>
        <% const updatedDays = (new Date() - new Date(post.updated)) / (1000 * 60 * 60 * 24); %>
        <% if (updatedDays <= 7) { %>
          <span class="updated-flag" data-updated="<%= post.updated.toISOString() %>">Updated within 7 days</span>
        <% } %>
      <% } %>
      <%# ----------------------------%>

    </div>
  <% } %>
</div>
```

>`span`æ ‡ç­¾æ˜¾ç¤ºâ€Updated within 7 daysâ€œï¼Œä¹Ÿå¯ä»¥æ¢æˆâ€Updatedâ€œ æˆ–è€…â€æ›´æ–°â€œã€‚

#### ä»£ç è§£æ

1. **`post.updated`**ï¼šæ£€æŸ¥æ–‡ç« æ˜¯å¦æœ‰ `updated` å±æ€§ã€‚
2. **è®¡ç®—æ—¶é—´å·®**ï¼š`(new Date() - new Date(post.updated)) / (1000 * 60 * 60 * 24)` å°†æ›´æ–°æ—¶é—´å·®è½¬æ¢ä¸ºå¤©æ•°ã€‚
3. **åˆ¤æ–­ 7 å¤©å†…**ï¼šå¦‚æœæ›´æ–°æ—¶é—´å·®å°äºç­‰äº 7 å¤©ï¼Œæ˜¾ç¤ºâ€œUpdatedâ€æ ‡å¿—ã€‚
4. **`data-updated` å±æ€§**ï¼šå°†æ›´æ–°æ—¶é—´ä»¥ ISO æ ¼å¼å†™å…¥ `data-updated`ï¼Œä¾› JavaScript ä½¿ç”¨ã€‚


### **æ­¥éª¤ 2ï¼šåˆ›å»ºåŠ¨æ€è„šæœ¬**

åœ¨ä¸»é¢˜çš„ `source/js/` æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ `update-flag.js`ï¼Œç”¨äºåŠ¨æ€éšè—è¿‡æœŸçš„æ ‡å¿—ã€‚

æ–‡ä»¶è·¯å¾„ï¼š`themes/fluid/source/js/update-flag.js`

æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```javascript
document.addEventListener("DOMContentLoaded", () => {
  console.log("DOM fully loaded");
  const updateFlags = document.querySelectorAll('.updated-flag');
  console.log("Found updated flags:", updateFlags);

  const expiryDays = 7; // è®¾ç½®æœ‰æ•ˆæœŸä¸º 7 å¤©
  const expiryTime = expiryDays * 24 * 60 * 60 * 1000; // è½¬æ¢ä¸ºæ¯«ç§’

  updateFlags.forEach(flag => {
    const updatedDate = new Date(flag.dataset.updated); // ä» data-updated è·å–æ—¶é—´
    const timeDiff = Date.now() - updatedDate.getTime(); // å½“å‰æ—¶é—´ä¸æ›´æ–°æ—¶é—´çš„å·®

    console.log(`Article updated on: ${updatedDate}, Time difference: ${timeDiff / (1000 * 60 * 60 * 24)} days`);

    if (timeDiff > expiryTime) {
      console.log("Hiding outdated updated flag");
      flag.style.display = 'none'; // éšè—è¿‡æœŸæ ‡å¿—
    }
  });
});
```



### **æ­¥éª¤ 3ï¼šç¡®ä¿è„šæœ¬è¢«åŠ è½½**

åœ¨ä¸»é¢˜çš„ `scripts.ejs` æ–‡ä»¶ä¸­ã€‚
é€šå¸¸ä½äº `themes/fluid/layout/_partial/scripts.ejs`ï¼‰ï¼Œæ·»åŠ å¯¹ `update-flag.js` çš„å¼•ç”¨ï¼š

```html
<script src="/js/update-flag.js" defer></script>
```

`defer` ç¡®ä¿è„šæœ¬åœ¨é¡µé¢å†…å®¹åŠ è½½å®Œæˆåæ‰§è¡Œã€‚



### **æ­¥éª¤ 4ï¼šå®šä¹‰æ ·å¼**

ä¸ºâ€œUpdatedâ€æ ‡å¿—æ·»åŠ æ ·å¼ï¼Œä½¿å…¶åœ¨é¡µé¢ä¸Šæ˜¾çœ¼ä¸”ç¾è§‚ã€‚æ‰¾åˆ°ä¸»é¢˜çš„ CSS æ–‡ä»¶ã€‚
é€šå¸¸æ˜¯`themes/fluid/source/css/_pages/_base/color-schema.styl`ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```css
.updated-flag {
  background-color: #ff0000; /* çº¢è‰²èƒŒæ™¯ */
  color: white;             /* ç™½è‰²æ–‡å­— */
  font-size: 0.8em;         /* å°å­—å· */
  padding: 2px 5px;         /* å†…è¾¹è· */
  border-radius: 3px;       /* åœ†è§’ */
  margin-left: 5px;         
}
```

è™½ç„¶`styl`æ–‡ä»¶æ”¯æŒcssï¼Œä½†æ˜¯ä»¥é˜²ä¸‡ä¸€ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š

```styl
.updated-flag
  background-color #5d8744
  color white
  font-size 0.8em
  padding 2px 5px
  border-radius 3px
  margin-left 5px 
```


### **æ­¥éª¤ 5ï¼šæµ‹è¯•å¹¶éªŒè¯**

#### 1. **åˆ›å»ºæµ‹è¯•æ–‡ä»¶**
   
   åœ¨`source/_posts`ä¸‹é¢åˆ›å»ºæ–‡ç« `test.md`ã€‚ä¿®æ”¹æŸç¯‡æ–‡ç« çš„ Front Matterï¼Œè®© `updated` æ—¶é—´ä¸ºè¿‘æœŸæˆ–è¾ƒæ—©çš„æ—¥æœŸï¼Œæ­¤æ–‡ç« è¶…è¿‡7å¤©ï¼Œ`updated`æ ‡å¿—æ¶ˆå¤±ï¼Œå¯ä»¥ä¿®æ”¹å…¶æ–‡ç« å·²æµ‹è¯•æ˜¾ç¤º`updated`ï¼š
   ```yaml
   title: test
   date: 2025-01-01
   updated: 2025-01-08
   ```

#### 2. **ç”Ÿæˆå’Œéƒ¨ç½²**
   è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå¹¶æŸ¥çœ‹ç½‘ç«™ï¼š
   ```bash
   hexo clean
   hexo generate
   hexo server
   ```

#### **éªŒè¯æ•ˆæœ**
   - å¦‚æœæ–‡ç« çš„æ›´æ–°æ—¶é—´åœ¨ 7 å¤©å†…ï¼Œé¡µé¢åº”æ˜¾ç¤ºâ€œUpdatedâ€æ ‡å¿—ã€‚
   - å¦‚æœè¶…è¿‡ 7 å¤©ï¼Œæ ‡å¿—åº”åŠ¨æ€éšè—ã€‚



å¸Œæœ›æœ¬æ•™ç¨‹èƒ½å¸®åŠ©ä½ ä¼˜åŒ–åšå®¢çš„ç”¨æˆ·ä½“éªŒï¼å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿ç•™è¨€äº¤æµï¼ ğŸš€



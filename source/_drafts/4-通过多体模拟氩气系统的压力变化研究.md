---
title: 通过多体模拟氩气系统的压力变化研究
date: 2025-02-13 13:52:48
tags:
  - Physics
  - modelling
  - projects
  - Python
categories:
  - projects
---



## **1. 任务背景与目标**
这份文档是关于一个科学计算课程的期末评估任务，要求编写一个**N体模拟代码**，用于研究氩原子在盒子中的行为。具体来说：
- **N体模拟**：跟踪一组粒子的位置和速度，并通过粒子之间的相互作用力计算它们的加速度。
- **应用背景**：使用该代码研究气体的行为，例如压力如何随系统参数（如体积、温度等）变化。

## **2. 物理模型与数学公式**
### **(1) N体模拟的基本原理**
- 每个粒子 \( i \) 的位置为 \( \mathbf{r}_i \)，速度为 \( \mathbf{v}_i \)。
- 粒子之间的作用力 \( \mathbf{F}_{ij} \) 决定了粒子的加速度 \( \mathbf{a}_i \)。
- 根据牛顿第二定律：
  \[
  \mathbf{a}_i = \frac{1}{m_i} \sum_{j \neq i} \mathbf{F}_{ij}
  \]
  其中 \( m_i \) 是粒子的质量。

### **(2) Verlet Leap-Frog 积分方法**
为了数值求解粒子的动力学行为，使用了一种称为 **Verlet Leap-Frog** 的积分方法：
1. 更新速度（基于当前加速度的一半时间步长）：
   \[
   \mathbf{v}_i = \mathbf{v}_i + \frac{\delta t}{2} \mathbf{a}_i
   \]
2. 更新位置（基于新速度的完整时间步长）：
   \[
   \mathbf{r}_i = \mathbf{r}_i + \delta t \mathbf{v}_i
   \]
3. 使用新的位置重新计算加速度，然后更新速度的剩余一半时间步长：
   \[
   \mathbf{v}_i = \mathbf{v}_i + \frac{\delta t}{2} \mathbf{a}_i
   \]

### **(3) Lennard-Jones 势能模型**
粒子之间的相互作用通过 **Lennard-Jones 势能**建模：
\[
V(r) = 4 \epsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - \left( \frac{\sigma}{r} \right)^6 \right]
\]
- \( r \) 是粒子间的距离。
- \( \epsilon \) 和 \( \sigma \) 是与原子相关的参数。
- 对于氩原子：
  \[
  \frac{\epsilon}{k_B} = 125.7 \, \text{K}, \quad \sigma = 0.3345 \times 10^{-9} \, \text{m}
  \]
  其中 \( k_B = 1.38 \times 10^{-23} \, \text{J/K} \) 是玻尔兹曼常数。

势能转化为作用力的公式为：
\[
\mathbf{F} = -\frac{dV}{dr}
\]



## **3. 任务分解**
### **Part 1: 编写 N 体模拟代码**
- **Task 1**: 创建一个程序实现上述积分方法，模拟 \( N \) 个粒子的运动。
- 需要验证代码对两个粒子系统的正确性（粒子间距约为 \( \sigma \)）。
- 建议优化代码效率，尽量使用数组操作代替循环。

### **Part 2: 添加边界条件**
- **Task 2**: 将粒子限制在一个立方盒中，边长为 \( L \)。
- 边界条件：当粒子碰到盒子壁时，反弹并保持弹性碰撞（即速度方向反转，大小不变）。
- 验证粒子在边界处的行为是否符合预期。

### **Part 3: 探究气体行为**
- **Task 3**: 使用完整的代码研究气体的行为，特别是以下问题：
  - 气体的压力如何随盒子体积和温度变化？
  - 计算气体的总动能：
    \[
    E = \sum_{i=1}^N \frac{1}{2} m_i v_i^2 = \frac{3}{2} N k_B T
    \]
  - 压力定义为单位时间内穿过单位面积的动量流：
    \[
    P_x = \frac{1}{A \Delta t} \sum m_i v_{x,i}^2
    \]
    如果系统处于平衡状态，则压力各向同性：
    \[
    P_x = P_y = P_z = \frac{1}{3} P
    \]


### **5. 提示与建议**
- 初始化粒子位置时，建议使用网格分布，且网格间距不小于 \( \sigma \)，以避免因势能函数在小 \( r \) 处的陡峭变化导致过大的力。
- 运行时间与粒子数量的选择需要权衡计算效率和结果准确性。

---

### **总结**
任务是通过编程实现一个物理模拟器，研究气体的行为。主要涉及以下几个方面：
1. 数值积分方法（Verlet Leap-Frog）。
2. 粒子间相互作用的物理模型（Lennard-Jones 势能）。
3. 边界条件的实现与验证。
4. 气体宏观性质（如压力、温度）的研究。


## 具体呈现细节


### **1. 整体目标**
目标是通过模拟氩原子在盒子中的运动，研究气体的行为。具体包括以下几个方面：
1. **N体模拟**：跟踪粒子的位置和速度，并根据粒子之间的相互作用力计算加速度。
2. **能量守恒检查**：通过调整时间步长 `dt`，确保模拟过程中系统的总能量（动能 + 势能）守恒。
3. **推荐时间步长**：找到一个合适的时间步长 `dt`，使得能量误差在可接受范围内（如 ≤ 1e-3）。
4. **可视化**：绘制不同时间步长下的相对能量误差曲线，帮助分析时间步长对模拟精度的影响。

---

### **2. 主要公式与物理模型**

#### **(1) Lennard-Jones 势能与力**
- **势能公式**：
  \[
  V(r) = 4 \epsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - \left( \frac{\sigma}{r} \right)^6 \right]
  \]
  其中 \( r \) 是粒子间的距离，\( \epsilon \) 和 \( \sigma \) 是与氩原子相关的参数。

- **力公式**：
  \[
  F(r) = -\frac{dV}{dr} = 48 \epsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - \frac{1}{2} \left( \frac{\sigma}{r} \right)^6 \right]
  \]

#### **(2) Verlet 积分方法**
Verlet Leap-Frog 方法用于数值求解粒子的动力学行为：
1. 更新速度（基于当前加速度的一半时间步长）：
   \[
   \mathbf{v}_i = \mathbf{v}_i + \frac{\delta t}{2} \mathbf{a}_i
   \]
2. 更新位置（基于新速度的完整时间步长）：
   \[
   \mathbf{r}_i = \mathbf{r}_i + \delta t \mathbf{v}_i
   \]
3. 使用新的位置重新计算加速度，然后更新速度的剩余一半时间步长：
   \[
   \mathbf{v}_i = \mathbf{v}_i + \frac{\delta t}{2} \mathbf{a}_i
   \]
#### **(3) 能量计算**
- **动能公式**：
  \[
  E_k = \sum_{i=1}^N \frac{1}{2} m_i v_i^2
  \]
- **势能公式**：
  \[
  E_p = \sum_{i < j} V(r_{ij})
  \]
  其中 \( r_{ij} \) 是粒子 \( i \) 和 \( j \) 之间的距离。
- **总能量**：
  \[
  E_{\text{total}} = E_k + E_p
  \]

#### **(4) 相对能量误差**
相对能量误差定义为：
\[
\text{Relative Energy Error} = \frac{|E_{\text{final}} - E_{\text{initial}}|}{E_{\text{initial}}}
\]
其中 \( E_{\text{initial}} \) 和 \( E_{\text{final}} \) 分别是初始和最终的总能量。

---

### **3. 各部分功能与思路**

#### **(1) `find_recommended_dt` 函数**
- **功能**：通过多次试验，找到一个合适的时间步长 `dt`，使得模拟过程中的相对能量误差小于指定阈值（如 1e-3）。
- **思路**：
  1. 初始时间步长为 `dt`。
  2. 运行 Verlet 积分并计算相对能量误差。
  3. 如果误差过大，则将时间步长减半，重复上述步骤，直到误差满足要求或达到最大试验次数。
  4. 返回推荐的时间步长和每次试验的相对能量误差。

#### **(2) 初始化粒子位置和速度**
- **功能**：生成初始粒子位置和速度。
- **思路**：
  1. 使用立方晶格初始化粒子位置，避免粒子间距过小导致势能过高。
  2. 为每个粒子赋予随机初速度，以模拟热运动。

#### **(3) Verlet 积分与能量守恒检查**
- **功能**：执行 Verlet 积分并检查能量守恒。
- **思路**：
  1. 在每次迭代中，更新粒子的速度和位置。
  2. 计算系统的初始和最终总能量，并计算相对能量误差。
  3. 如果误差过大，则调整时间步长。

#### **(4) 可视化**
- **功能**：绘制不同时间步长下的相对能量误差曲线。
- **思路**：
  1. 横轴为时间步长（对数刻度），纵轴为相对能量误差（对数刻度）。
  2. 通过图表直观展示时间步长对能量守恒的影响。

---

### **4. 总结**
核心是通过 Verlet 积分模拟粒子的动力学行为，并通过能量守恒检查来优化时间步长。主要涉及以下内容：
1. **Lennard-Jones 势能与力**：描述粒子间的相互作用。
2. **Verlet 积分**：数值求解粒子的动力学方程。
3. **能量守恒检查**：确保模拟的物理合理性。
4. **时间步长优化**：找到合适的 `dt` 以平衡精度和效率。
5. **可视化**：通过图表分析时间步长对模拟结果的影响。

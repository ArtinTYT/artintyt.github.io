---
title: 足球应用中的成对比较研究
date: 2025-02-15 13:52:24
tags:
  - Statistical_modelling
  - Maths
  - Projects
  - Python

categories:
  - Projects
  
  
  
---

## 摘要
本报告探讨了足球中的预测建模，并研究了多种模型，包括Thurstone模型、Bradley-Terry模型、Rao-Kupper模型、Davidson模型、Maher模型、Dixon-Coles模型和多项式逻辑回归模型。我们使用合成数据和真实比赛数据测试了Davidson模型、Dixon-Coles模型和多项式逻辑回归模型。我们还通过将Dixon-Coles模型和多项式逻辑回归模型结合，创建了一个新模型以提高预测精度。该组合模型将准确率提高了约15%，达到了65%的成功率。这些发现展示了先进建模技术在体育管理和博彩行业中的有效性，突出了优化和整合复杂变量进入模型的重要性。

## **引言：**
在足球比赛预测中，最常用的方法是配对比较。配对比较是一种常用于心理学的方法，通常涉及一次评估两个实体，以确定哪个更受偏好，哪个具有某个定量属性更多，或评估这两个实体是否相同。Bradley-Terry模型是最常用且最著名的配对比较模型。该模型通过将项目成对比较来对其进行排名和比较。在探索和研究过程中，人们发现最早的配对比较模型是由Frederick Mosteller提出的Thurstone模型，该模型使用正态分布计算A比B更优的概率。Ralph Allan Bradley基于Thurstone模型，替换了正态分布，采用了平方双曲余切分布，并提出了Bradley-Terry模型，他将该模型简化为比例形式。Rao和Kupper基于Bradley-Terry模型，添加了一个新的阈值参数，以适应实际应用场景（胜、负、平），而不仅仅是（胜、负），并提出了Rao-Kupper模型。Roger R. Davidson在Bradley-Terry模型的基础上进一步发展，提出了Davidson模型，并将其与Rao-Kupper模型进行了比较。Davidson模型引入了一个尺度常数，简化了模型，使得三种结果（胜、负、平）的分母相同。然而，实际应用场景往往更为复杂。Maher提出了Maher模型，该模型使用泊松分布来考虑足球比赛中球队的进攻和防守能力，直接预测进球数，而不仅仅是胜利的概率。在Maher的思想基础上，Dixon和Coles进一步优化了该方法，考虑了低得分情况（0-0，1-0）、主场优势和队际互动。因此，他们提出了Dixon-Coles模型，用于预测足球博彩行业的赔率。

在体育分析领域，准确预测足球比赛结果是一个重要的挑战，吸引了研究人员和球迷的关注。本报告的实验部分重点研究了Davidson模型、Dixon-Coles模型和逻辑回归模型在这些预测中的表现。通过使用合成数据和真实世界数据进行实验，我们将测试这些模型在预测比赛结果方面的效果，突显它们在足球分析中的有效性。在本部分的后续，我们还探讨了一种新的方法，通过将这两种模型整合到一个统一框架中，研究这种集成模型是否能够提高足球比赛预测的准确性。



## **Thurstone模型**

### **介绍**
Thurstone模型是一种用于感官差异测试的方法，它将各种刺激按感知尺度进行排名，以便进行比较分析。在该模型中，一组刺激记为\(O_1, O_2, ..., O_n\)，这些刺激根据它们在个体中引发的感觉\(X_i\)进行定量比较。这些感觉被假定在一个群体中呈正态分布，每个\(X_i\)位于感官连续体\(S\)上。

感官连续体\(S\)充当了这些感觉的定量尺度，每个感觉\(X_i\)都有一个相关的均值\(S_i\)。这个均值\(S_i\)表示在整个群体中刺激\(O_i\)的平均感知强度或偏好，将每个刺激根据其引发的感觉均值放置在连续体上。

以下的模型公式对Frederick Mosteller的思想进行了简洁的数学总结，将他的概念性研究转化为一个结构化的数学模型。

### **结论**
总而言之，Thurstone模型基于一个连续体的概念，每个项目（或刺激）都有一个位置，代表其“强度”或偏好水平。偏好刺激\(i\)而不是\(j\)的概率(\(p_{ij}\))被建模为感知强度差异(\(S_i - S_j\))右侧的正态分布曲线下的面积。这个模型本质上假设感知差异是正态分布的，从而得出方程eq:4。

然而，尽管Thurstone模型在偏好分析的概率方法上很复杂，但它受限于对正态分布的依赖和刺激之间的恒定相关性。这些假设在现实场景中可能不成立，因为数据可能不是正态分布的，或者刺激之间的关系可能有所不同。这些不一致性使得该模型在计算上比较复杂，因此不适用于大规模数据集或需要快速决策的环境。

简化后的方程eq:5代表了Bradley-Terry模型的原型，它通过将分布假设简化为一个基于比率的模型，解决了这些问题，提高了计算效率和适用性。

## **Bradley-Terry模型**

### **介绍**
由Ralph Allan Bradley提出的核心Bradley-Terry模型，经过进一步的重新定义，将Thurstone模型中使用的正态分布转化为平方双曲余切（逻辑密度）分布。以下模型公式主要集中在Bradley-Terry模型上，特意省略了之前详细讨论的Thurstone模型。

### **结论**
总而言之，当通过对数变换（\(S_i = \log(\pi_i)\)）进行转换时，它主要用于将乘法关系简化为加法关系。将模型表示为比率，从而以一种改进计算效率和数值稳定性的方式管理原始乘法关系。

然而，Bradley-Terry模型存在一定的局限性，因为它要求对任何两个项目做出明确的偏好选择，这与现实应用场景不符。接下来，我们将介绍Rao-Kupper模型，通过考虑第三种情况（A和B的情况都可能）来解决这一问题。

## **Rao-Kupper模型**

### **介绍**
Rao和Kupper扩展了Bradley-Terry模型，用于配对比较实验，通过引入一个阈值参数\(\eta\)，从而引入了处理平局（不确定）的可能性。这一发展解决了Bradley-Terry模型固有的局限性，即要求对任何两个处理做出明确的偏好选择。

在Rao-Kupper模型中，设置了一个新的参数\(\theta = \exp(\eta)\)，调整模型以保持比率形式，同时承认配对比较中的不可区分结果，从而增强了该模型在现实场景中的适用性。此外，偏好强度\(\pi_i\)的范围被明确规定。

### **结论**
总而言之，在现实场景中，当两个处理的比较强度非常接近时，评审或决策者可能无法区分它们的差异。\(\eta\)模型化了这一阈值，使得模型能够更细致地表示偏好，包括平局的可能性。

然而，尽管Rao-Kupper模型能够通过一个简单的比率模型保持\( p_{ij} \)或\( p_{ji} \)的表示，\( p_0 \)仍然表现为一个复杂的模型。此外，这三种模型的分母是统一的。Davidson模型通过使用一个更简洁的模型来表示平局的情况，解决了这个问题。

## **Davidson模型**

### **介绍**
Roger R. Davidson引入了一个比例常数\(v\)，并基于Luce选择公理和几何平均数，建立了一个新的模型，统一了模型的分母。虽然Rao-Kupper模型和Davidson模型都是Bradley-Terry模型的扩展，但两者之间存在显著差异。

### **结论**
总而言之，在Rao-Kupper模型中，概率\( p_{ij} \)和\( p_{ji} \)的分母受到对方刺激强度\(\pi_j\)和\(\pi_i\)的影响。而在Davidson模型中，通过结合两刺激强度的几何平均数\( \sqrt{\pi_i \pi_j} \)，标准化了\( p(i \mid i, j) \)和\( p(j \mid i, j) \)的分母。这导致了Davidson模型中分母的一致性，从而简化了其发展和分析。

然而，之前的模型在考虑现实应用场景时仍存在不足，例如量化防守和进攻能力的问题。Maher模型基于泊松分布，解决了这些问题，并计算了每支队伍预期进球的数量。


## **Maher模型**

### **介绍**
首先，根据Maher的研究，我们简要介绍足球预测研究的历史背景，并进行更详细的解释。

Maher的研究强调，负二项分布比泊松分布更适合足球比赛数据。泊松分布通常用于建模固定时间或空间间隔内的稀有事件，假设数据的均值和方差相等。然而，在足球进球数据中，方差通常大于均值，这种现象被称为过度离散。过度离散表明泊松模型可能无法准确反映进球数量的变异性。负二项分布具有一个额外的参数，使得方差可以超过均值，更适合建模显示显著过度离散的计数数据，如足球进球。

随着时间的推移，对足球动态的理解不断发展。最初，不可预测性被视为足球的关键因素，比赛结果被认为主要由机会（运气）主导。然而，后来的研究表明，技术比运气在决定比赛结果方面更具决定性作用。尽管如此，Maher批评了足球主要是一个靠运气的游戏的观点。他引用了早期研究的结果，表明运气在影响足球结果方面往往超过了技术。然而，Maher也探讨了泊松分布在足球进球中的适用性，考虑到该运动频繁的控球和进攻机会。每次进攻，尽管它带有一个小而一致的进球概率，但当在多次进攻中汇总时，可以形成一个近似泊松分布的进球分布。

### **结论**
总而言之，Maher模型比之前的模型更复杂，因为它使用了泊松分布。该模型更贴近现实应用场景，能够直接计算每支球队的得分，同时考虑其进攻和防守能力。因此，它提高了预测胜负的准确性，从单纯考虑胜利的概率转变为具体计算得分。

然而，在现实场景中，除了考虑球队的进攻和防守能力外，还需要考虑主客场优势。此外，低得分情况也需要纳入考虑。Dixon-Coles模型解决了这些问题。


### **Dixon-Coles模型**

### **介绍**
Dixon-Coles模型改进了Maher模型，用于解决足球博彩中的挑战。Maher模型使用独立的泊松分布表示主队和客队的进球数。Dixon和Coles通过引入一个新的参数\(\gamma\)，考虑了主场优势，从而改进了这个模型。

尽管模型的复杂度增加，Dixon-Coles模型不同于Maher模型，它考虑了球队表现之间的依赖性\(\rho\)。它根据一方进攻或防守对另一方的影响调整概率。这些调整使得该模型能够提供具体的比赛概率估算，能够与博彩公司设定的固定赔率进行比较，帮助投注者识别出有利回报的投注机会。

### **结论**
总之，Dixon-Coles模型不仅考虑了主客场优势，还考虑了进攻和防守的强度。它还解决了低得分问题（如0-1，0-0），并能够更准确地修正低得分比赛的概率，提升了对平局和接近比赛的预测。通过\(\rho\)调整球队之间的依赖性。使用先进的最大似然法，它提供了更可靠的参数估计。预测概率可以直接与博彩公司赔率进行比较，以识别有价值的投注机会，尤其对投注者非常有用。

## **多项式逻辑回归模型**

### **介绍**
多项式逻辑回归模型是一种强大的统计工具，适用于分析分类为多个无序组的因变量。该模型在整合多种独立变量（无论是数值型还是类别型）方面表现出色。通过估算参数，它提供了独立变量对各个类别发生的可能性的定量影响度量，能够全面评估它们的影响。

## **结论**
总结这一数学模型部分，我们首先介绍了Thurstone模型，它为Bradley-Terry模型的开发奠定了基础。Bradley-Terry模型将比较简化为比例形式，用于计算团队A更可能战胜团队B的概率。然而，Rao-Kupper模型通过引入平局的可能性，扩展了Bradley-Terry模型，解决了A和B之间无法简单区分胜负的情况。Davidson模型进一步优化了Rao-Kupper模型，通过保持所有三种结果（胜、负、平）的公共分母，同时保持比例形式，以便于解释。在实际场景中，我们可能想知道某支球队可能进多少个球，而不仅仅是获胜的概率。Maher模型适用于这种情况，它考虑了每支球队的进攻和防守能力。在足球博彩行业中，需要具体考虑投注策略以获得更好的回报。因此，我们不仅要考虑进攻和防守的强度，还要考虑主场优势的影响。
